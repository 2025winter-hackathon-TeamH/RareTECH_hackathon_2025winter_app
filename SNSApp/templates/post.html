<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>post(トップページ)</title>
    <link rel="stylesheet" href="../static/css/post.css">
  </head>
  <body>
    <header>
      <img src="../static/site_logo.png" alt="背水の陣ロゴ">
    </header>

    <main>

      <div class="pankuzu">
        <p >トップページ</p>
      </div>
      <div class="btn-area">
        <a class="btn-mypage-link" href="/my-page">自分の投稿一覧</a>
        <a class="btn-logaut" href="/logout">ログアウト</a>
      </div>
      <!--====== フラッシュメッセージ表示 ======-->
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
        <div class="flash flash-{{ category }}">
          {{ message }}
        </div>
        {% endfor %}
      </div>
      {% endif %}
      {% endwith %}
      <!--====== 新規投稿フォーム ======-->
      <form class="post-form" action="/goal-posts" method="post" id="goal">

        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <div>
          <label for="goal-input">目標入力</label>
          <textarea id="goal-input" name="goal_message" placeholder="  決意表明！"></textarea>
        </div>
        <div>
          <label for="deadline">達成期日</label>
          <input class="deadline" id="deadline" type="date" name="goal_deadline">
          <button class="btn-goal" for="goal" type="submit">投稿</button>
        </div>
      </form>

       <!-- ===== 投稿一覧の表示　goals　があれば表示する　===== -->

      {% if goals and goals|length > 0 %}
        {% for goal in goals %}
          <div class="post-card">
            <div class="post-card-header">
              <div class="post-name">{{ goal.user_name }}</div>
              <div class="post-update">{{ goal.goal_created_at }}</div>
            </div>

            <div class="post-goal">{{ goal.goal_message }}</div>
            <div class="post-deadline">{{ goal.goal_deadline }}</div>
            
            <div class="post-card-footer">
              <form action="/goal-post/{{ goal.id }}/reaction-ganba" method="post">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button class="ganbare" type="submit">頑張れ ! ： {{ goal</button>
              </form>
              <form action="/goal-post/{{ goal.id }}/reaction-dousita" method="post">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button class="dousita" type="submit">どうした ? ：  0</button>
              </form>
              <a class="btn-progress" href="/goal-post/{{ goal.id }}">進捗</a>  
            </div>
          </div>
        {% endfor %}
      {% else %}
      <div class="empty">
        <p>投稿がありません。</p>
      </div>
      {% endif %}
<!--      
     {# 
      <div class="post-card-tassei">
        <div class="post-card-header">
          <div class="post-name">佐藤文夏</div>
          <div class="post-update">更新日：2026-01-12 22:20</div>
        </div>
        <div class="post-goal">7/20までに夏コミ用の早期入稿をする...絶対</div>
        <div class="post-deadline">期日：2026/7/20</div>
        <div class="post-card-footer">
          <button class="ganbare" type="submit">頑張れ ! ：  2</button>
          <button class="dousita" type="submit">どうした ? ：  0</button>
          <a class="btn-progress" href="/goal-post/{{ goal.id }}">進捗</a>  
        </div>
      </div>
      
      <div class="post-card-dannen">
        <div class="post-card-header">
          <div class="post-name">佐藤文夏</div>
          <div class="post-update">更新日：2026-01-12 22:20</div>
        </div>
        <div class="post-goal">7/20までに夏コミ用の早期入稿をする...絶対</div>
        <div class="post-deadline">期日：2026/7/20</div>
        <div class="post-card-footer">
          <button class="ganbare" type="submit">頑張れ ! ：  2</button>
          <button class="dousita" type="submit">どうした ? ：  0</button>
          <a class="btn-progress" href="/goal-post/{{ goal.id }}">進捗</a>  
        </div>
      </div>
#}
-->
    </main>
    <footer>2026&copy ハッカソン冬の陣 チームH 背水の陣制作委員会</footer>
  </body>
</html>
